
1. Access to get login code(GET)
https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=e381aebb-dbbf-4a6f-a9c2-34ebfbdf9424&response_type=code&scope=offline_access%20user.read%20mail.read&redirect_uri=https://zfile.jun6.net/onedrive/callback


2. use login code to get accessToken & refreshToken(POST) -> Content-Type: application/x-www-form-urlencoded
https://login.microsoftonline.com/common/oauth2/v2.0/token?client_id=e381aebb-dbbf-4a6f-a9c2-34ebfbdf9424&redirect_uri=https://zfile.jun6.net/onedrive/callback&client_secret=@:7GJyOhl@KVgKH1ezV_ACtxTBbCjD56&code=OAQABAAIAAAAm-06blBE1TpVMil8KPQ41mmg3IhxXaV5g9xdGQOCsAHrOAmGendRUZe1DU3N6PdDEDf5JSsGsV9cXHeqeoJHr_e69S6kdlwrGX_E9KKHiyo943r5AZ2ThNlu7UfVS5mLgwz-Y9CWdGCdGAs6SnOnMWFKTEmgqeD3eVeFobFoPiSI3p6ZCbNU9kTNIfH3bM1eJXjvMY8lesE0KR2SH9M92dY4ONIAjDZHvN1RYmDuCvH02-rR1mRHmiVd_3gOU3O-htd4AVr6CChhP21WIC5l1f4H1v1phCMzdiHlPRVAhD0Pn2KMfQ6dTCyVv44jpLoYT7A9xd2HHkes2B21oxURN3aAbNWArnx2rD2AWAT9jG9lERqYlRkboz7cqX4SRrpy15Zw64-Id_IZm89ecxv9cgbqMjNNAEyE-cRO4mqAb6qfwINJ5B5GFN4X6GOk-4hQ1a32BVKPGv79e_3jEgtKT4l2ehTtvRbBYRI-UFmen8nzqiyDN4GD-KgO_R8A4_SHRD0LAg4C0ZoTlM6Zx-kwDBd-NIH1FjydJB3hJJ-JpGE0WHOOIENZPVsUo1B18JYiOuGjNnm5J9w9J6q9LlP4-0XFaYvRqRXY9Tz-mSzS1WuD9YCCQcjunUiBt8LCIOwu1YUNBabo2q-_4bVpabY8_3A5uyvqmR6LDf1tqdws3VyAA&scope=offline_access%20user.read%20mail.read&grant_type=authorization_code

Result:
{"token_type":"Bearer","scope":"Files.Read Files.Read.All Files.Read.Selected Files.ReadWrite Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Mail.Read Sites.Read.All User.Read profile openid email","expires_in":3599,"ext_expires_in":3599,"access_token":"eyJ0eXAiOiJKV1QiLCJub25jZSI6ImpqQmo0aFNWVndiazhWaFhqcXEtZkFfd1FBSk9MNGx5TWZVN2Y3Y2hqSEUiLCJhbGciOiJSUzI1NiIsIng1dCI6IllNRUxIVDBndmIwbXhvU0RvWWZvbWpxZmpZVSIsImtpZCI6IllNRUxIVDBndmIwbXhvU0RvWWZvbWpxZmpZVSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC80ODM1MGU3OC1iM2Q4LTQxNDgtYTE2Ni0zNGI2MDJiMWQ1MWEvIiwiaWF0IjoxNTg3NTI0NDAxLCJuYmYiOjE1ODc1MjQ0MDEsImV4cCI6MTU4NzUyODMwMSwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IjQyZGdZTmdSR3hUc2I5TjRjSFpmaGVBN3g4ai9xdzB2Um91WFMweDRxS2N1bjg3SGtnNEEiLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6Ik15IEphdmEgR3JhcGgiLCJhcHBpZCI6ImUzODFhZWJiLWRiYmYtNGE2Zi1hOWMyLTM0ZWJmYmRmOTQyNCIsImFwcGlkYWNyIjoiMSIsImZhbWlseV9uYW1lIjoiaGUiLCJnaXZlbl9uYW1lIjoicWluZ3JhbiIsImlwYWRkciI6IjIwMy4xMjYuMTMwLjE0MCIsIm5hbWUiOiJhZG1pbmlzdHJhdG9yIiwib2lkIjoiODgzOTNhOTAtYzMwZi00NjNkLThmOTYtOWNmNzhlZDJkZmY3IiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDAwOTg5Qjk5MjAiLCJwd2RfZXhwIjoiNjgzOTQwIiwicHdkX3VybCI6Imh0dHBzOi8vcG9ydGFsLm1pY3Jvc29mdG9ubGluZS5jb20vQ2hhbmdlUGFzc3dvcmQuYXNweCIsInNjcCI6IkZpbGVzLlJlYWQgRmlsZXMuUmVhZC5BbGwgRmlsZXMuUmVhZC5TZWxlY3RlZCBGaWxlcy5SZWFkV3JpdGUgRmlsZXMuUmVhZFdyaXRlLkFsbCBGaWxlcy5SZWFkV3JpdGUuQXBwRm9sZGVyIEZpbGVzLlJlYWRXcml0ZS5TZWxlY3RlZCBNYWlsLlJlYWQgU2l0ZXMuUmVhZC5BbGwgVXNlci5SZWFkIHByb2ZpbGUgb3BlbmlkIGVtYWlsIiwic3ViIjoicTh1cjJ1TXBzdEh5Zkh0T0RFZU16dzdHdFlMQXE2V0hPNmtVWFF6LUIzQSIsInRpZCI6IjQ4MzUwZTc4LWIzZDgtNDE0OC1hMTY2LTM0YjYwMmIxZDUxYSIsInVuaXF1ZV9uYW1lIjoiYWRtaW5AaGxoaHJsLm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6ImFkbWluQGhsaGhybC5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiI4bkpYcGRHVmJVQ2VHRE1mZFNFLUFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiXSwieG1zX3N0Ijp7InN1YiI6IkUyaHU5X2ZfTHFrN3hybmphSDFCS1FtYjF1dE5waUhwNzNLWUxiYWhBWTgifSwieG1zX3RjZHQiOjE1ODA0MzI2NDF9.LX3rpbBl1tBbMrmRIxGhOl-_0XJ-Re3QCmQqEdZ-GQ_Gwp17UMxXspxPk11nNKCqsPNm8Pdogro5OvgWCPam4KmH7nVXc9NZSnr7yKjnaPN5AHSG7OGUNYEIkpAiWfZ8LPygVH29yfPIlEX1Inky0zS_gGZ59ENQxZNnXB3aYOhmEWQMOe2OILmYPtbgldOIGkf3HEPDlEKQqiP3WaLD2obs-YyRW1sJf3UxwmLZTKchHnAnAB9ys6GN-wj1-b8fvgPjynhsWAIwum0rv7Naf1qdE4CSQZtT0pgN7I1DJrlTjxDAixY_qAauYscdoFtbyaNWnzqgNXVyj9mhJaSCOQ","refresh_token":"OAQABAAAAAAAm-06blBE1TpVMil8KPQ41hbDoiO9GulOgunXD44OA6Oqpnx-CtOrkgAlRpticokrM6qqtPdJ2YyBrUfw8G6aQ8tM2MG7cVyaZOwjw8_23ASP4QgSateyGEUBapVxj-Ip6U_TI1ULL5avkPXo5tAuyOOkREvNKEJ9-NcnpjRL0IcnAe_O4fOZwV8JpCRpbLVbIZ3v7xVFHYaD4zIRuyXhNYjlu_KoWTHe6bOJjpqb2iP8J6mO0_4tL-U8GQxsWMVOC7EfEWJcxyli6TzzXc-btMOrUG-7O0d19bzoeNFjArp9NqnPxBQmW8m9zqJGb_wLL9Y-mPYblCWqz2q47XGdtq0ZsOettli9jP1OcwjHLTxcCkX2dbK02AZdsNB1qoc-WscbHWvEWOxlmfNxSu-EIn3EoLUHPJsp1FFUC1M4nCfRD8m-bwMtKQ3aU2lwY3BOGF3bqXUVlrBPXi7JyZOVOw3WeaSLqM7rmQV4HrBwnzxHpL2E0ijrggvB8q95BEfEKDLqpcEJkvYDHgkhRzFxilbpqJRUhZHCU-yeyFmhwJMbT0pocdxBOjK6wozsuARTfz1lNjP5TScbzPxevo-bsm3mztemRSAZT-vcmwiSIpfDDorBketAUYQzZ1kYPMthz4m8sg7Kpo9V1eaZG74xJla7EEKoGd0ig3O2URg_tIx2deUint7-q0L-aic1xKdclgCmE56bEnptc0LJSJtaMNMsZfUjfacRKeM-TFBOo2b8XmU_L6Yv5JUOiyJS7wyTI8f_wmyxSlYECWToLvcgnFwrhASQDb0hs68VW4XTLFJV0Mr1R88UL69zf8chjGujIPF3GfMW2vgdM2dfnBIolVBdQfdUhh5uIHeddHUSONyAA"}


3. Use refreshToken to get accessToken(POST) -> Content-Type: application/x-www-form-urlencoded
https://login.microsoftonline.com/common/oauth2/v2.0/token
client_id=e381aebb-dbbf-4a6f-a9c2-34ebfbdf9424
&scope=user.read%20mail.read
&refresh_token=OAQABAAAAAAAm-06blBE1TpVMil8KPQ41hbDoiO9GulOgunXD44OA6Oqpnx-CtOrkgAlRpticokrM6qqtPdJ2YyBrUfw8G6aQ8tM2MG7cVyaZOwjw8_23ASP4QgSateyGEUBapVxj-Ip6U_TI1ULL5avkPXo5tAuyOOkREvNKEJ9-NcnpjRL0IcnAe_O4fOZwV8JpCRpbLVbIZ3v7xVFHYaD4zIRuyXhNYjlu_KoWTHe6bOJjpqb2iP8J6mO0_4tL-U8GQxsWMVOC7EfEWJcxyli6TzzXc-btMOrUG-7O0d19bzoeNFjArp9NqnPxBQmW8m9zqJGb_wLL9Y-mPYblCWqz2q47XGdtq0ZsOettli9jP1OcwjHLTxcCkX2dbK02AZdsNB1qoc-WscbHWvEWOxlmfNxSu-EIn3EoLUHPJsp1FFUC1M4nCfRD8m-bwMtKQ3aU2lwY3BOGF3bqXUVlrBPXi7JyZOVOw3WeaSLqM7rmQV4HrBwnzxHpL2E0ijrggvB8q95BEfEKDLqpcEJkvYDHgkhRzFxilbpqJRUhZHCU-yeyFmhwJMbT0pocdxBOjK6wozsuARTfz1lNjP5TScbzPxevo-bsm3mztemRSAZT-vcmwiSIpfDDorBketAUYQzZ1kYPMthz4m8sg7Kpo9V1eaZG74xJla7EEKoGd0ig3O2URg_tIx2deUint7-q0L-aic1xKdclgCmE56bEnptc0LJSJtaMNMsZfUjfacRKeM-TFBOo2b8XmU_L6Yv5JUOiyJS7wyTI8f_wmyxSlYECWToLvcgnFwrhASQDb0hs68VW4XTLFJV0Mr1R88UL69zf8chjGujIPF3GfMW2vgdM2dfnBIolVBdQfdUhh5uIHeddHUSONyAA
&redirect_uri=https://zfile.jun6.net/onedrive/callback
&client_secret=@:7GJyOhl@KVgKH1ezV_ACtxTBbCjD56
&grant_type=refresh_token

Result:
{"token_type":"Bearer","scope":"Files.Read Files.Read.All Files.Read.Selected Files.ReadWrite Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Mail.Read Sites.Read.All User.Read profile openid email","expires_in":3599,"ext_expires_in":3599,"access_token":"eyJ0eXAiOiJKV1QiLCJub25jZSI6IkhPS0U0ckl3c2N5ZGZhSTNaN2ZjUTB1ZTBjOWVnZFZIVmhRVjhENDZkN1EiLCJhbGciOiJSUzI1NiIsIng1dCI6IllNRUxIVDBndmIwbXhvU0RvWWZvbWpxZmpZVSIsImtpZCI6IllNRUxIVDBndmIwbXhvU0RvWWZvbWpxZmpZVSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC80ODM1MGU3OC1iM2Q4LTQxNDgtYTE2Ni0zNGI2MDJiMWQ1MWEvIiwiaWF0IjoxNTg3NTI1MzIzLCJuYmYiOjE1ODc1MjUzMjMsImV4cCI6MTU4NzUyOTIyMywiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IjQyZGdZTER5TkhyV1lKRHZyaHY5VDN2dSt3akhaODJ5YXBjeXU5T25xKzNsU050dStSWUEiLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6Ik15IEphdmEgR3JhcGgiLCJhcHBpZCI6ImUzODFhZWJiLWRiYmYtNGE2Zi1hOWMyLTM0ZWJmYmRmOTQyNCIsImFwcGlkYWNyIjoiMSIsImZhbWlseV9uYW1lIjoiaGUiLCJnaXZlbl9uYW1lIjoicWluZ3JhbiIsImlwYWRkciI6IjIwMy4xMjYuMTMwLjE0MCIsIm5hbWUiOiJhZG1pbmlzdHJhdG9yIiwib2lkIjoiODgzOTNhOTAtYzMwZi00NjNkLThmOTYtOWNmNzhlZDJkZmY3IiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDAwOTg5Qjk5MjAiLCJwd2RfZXhwIjoiNjgzMDE4IiwicHdkX3VybCI6Imh0dHBzOi8vcG9ydGFsLm1pY3Jvc29mdG9ubGluZS5jb20vQ2hhbmdlUGFzc3dvcmQuYXNweCIsInNjcCI6IkZpbGVzLlJlYWQgRmlsZXMuUmVhZC5BbGwgRmlsZXMuUmVhZC5TZWxlY3RlZCBGaWxlcy5SZWFkV3JpdGUgRmlsZXMuUmVhZFdyaXRlLkFsbCBGaWxlcy5SZWFkV3JpdGUuQXBwRm9sZGVyIEZpbGVzLlJlYWRXcml0ZS5TZWxlY3RlZCBNYWlsLlJlYWQgU2l0ZXMuUmVhZC5BbGwgVXNlci5SZWFkIHByb2ZpbGUgb3BlbmlkIGVtYWlsIiwic3ViIjoicTh1cjJ1TXBzdEh5Zkh0T0RFZU16dzdHdFlMQXE2V0hPNmtVWFF6LUIzQSIsInRpZCI6IjQ4MzUwZTc4LWIzZDgtNDE0OC1hMTY2LTM0YjYwMmIxZDUxYSIsInVuaXF1ZV9uYW1lIjoiYWRtaW5AaGxoaHJsLm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6ImFkbWluQGhsaGhybC5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiJyWFBuT01wbWgwTzd5OWlMa0dBLUFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiXSwieG1zX3N0Ijp7InN1YiI6IkUyaHU5X2ZfTHFrN3hybmphSDFCS1FtYjF1dE5waUhwNzNLWUxiYWhBWTgifSwieG1zX3RjZHQiOjE1ODA0MzI2NDF9.RMlhrtObSLmYNQOFUFO808k1J1TDTGs-SPSeVzG2MWAkonHR5okaP2b4QCy8NN4xLMb-S2EM2iT27Yn0Mla-tl8qO7nIkERhPVY4KXXqcJnu6BPOZv_-goPTXrgv4E2pjqltfu07rKc4e82Knfnq73FuiTRpRiAL-g4BAfTcUlmoJvCd9sveF2ZK0KziOrBByygZ9jrItvBXcZ8MxIdJeO92ZlaQYZpQEoGIdvtAn0kOPzjF4FXZQUAhy0C3eixAIAKVcDUbybY7XV0ryNENySUrHYRmR8gxzYcW_7zubYnadf0vQQvUyRaogd14fNzZIgeYsLJP14158693ujFhNg","refresh_token":"OAQABAAAAAAAm-06blBE1TpVMil8KPQ41Y8VpJSRbQ5zN_tETd6Vy-dZ8vFuTT2Cc1MmFtia_1tJJIyM2W4veLefTLvEiMzKbN4q4ClaHt2ARdE5Jg4cbqS_SStfQ6SZAysskmLiYafaGMu2pUcKtrV-qAWvHkSIfYG0JgQrxCMGxlnz3s_T1jp678GMeMiOnDPgf_jz1jkcDcpX5RRktnImRFsB2Dn00OSRvd4jj1PY-_FS5nUQtVeZ-csOLsCnc_A46pbOd9luxkvqctBnMxvQh9NsgEJxCEkbZdaX_oU462lN9i6hz2IxvrDdZbOOjUG0AeW8a1fjMIWx5rbYAXXhcjEYlNtCNtuKcqfKUhJFAdli-irUytcsfsvSbcJOVh1Ttel1QmVO2TDdIuBpTMb0pNfvEFI-n9Vh124ESE-8Onpgtj-XeGD6SRUOYTwhwGQ_ks6WOlqXkdaUmTIph-67vzqjnfP2yJV85gWjnbCNHHLhhrt2Uni2GjA5vtC_O_Qkld1g4fYrM7Tt6Mb9eEx6k-MpTIadaPojPMGWvYwd8Yk6VJU6_WDEZHn96GBFUzyI-HgVxPEX-6e--kv038i7_kJ2ThDsYHq86EZBBlIxWqf25NZhB-9Si1_BTIL0zR0jMgCbYT5reCrblVft4WIlcbmKEdBtgCtQ-tj7_N1jwH_ZnYy-jgVBqBJHBPUNNZTT7ozgW4eHRyEQLgsSYqbFdHVDr7kUBjOrPjlGSqTTcFqJEZ64_6PtGEy5qUALk0uvF-2ooH_7ltT-1TCcLRJITnV8SdCfrdltRvWsHNa5C4kWRO5xXw4lLhOSYodKrySHpFV-yzGlAh48nuGlGOMAv_-vckmN9xlG6lEUcpRpAcnwmAvFdViAA"}


Use accessToken to access Azure Data

<include header Authorization : Bearer AccessToken for below request>
https://graph.microsoft.com/v1.0/me/mailfolders               -> list my mail folder
https://graph.microsoft.com/v1.0/me/messages                  -> list my emails
https://graph.microsoft.com/v1.0/me/messages?$select=subject  -> Only list my emails' subject
https://graph.microsoft.com/v1.0/me/drive/root/children       -> list the OD files

